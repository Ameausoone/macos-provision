---
# tasks file for mac-dev-playbook

- name: Create directories
  file:
    path: "{{ item }}"
    state: directory
    mode: 0755
  # become: true
  with_items:
    - "{{ansible_env.HOME}}/.ansible"
    - "{{ansible_env.HOME}}/.zshrc.d"
    - "{{ansible_env.HOME}}/.terraform.d/plugin-cache"
    - "{{ansible_env.HOME}}/.config"
    - "{{ansible_env.HOME}}/.zshrc.d/core"

- name: Copy recursively files in HOME directory to $HOME
  copy:
    src: "HOME/"
    dest: "{{ansible_env.HOME}}/"
  notify: execute source shell_dotfile
  tags:
    - dotfiles

- name: Copy templated dot files
  template:
    src: "dotfiles/{{ item.src }}"
    dest: "{{ansible_env.HOME}}/{{ item.dest }}"
    mode: 0744
  loop:
    - {src: ".gitconfig.j2", dest: ".gitconfig"}
  notify: execute source shell_dotfile
  tags:
    - dotfiles

- name: Copy zsh files
  copy:
    src: ".zshrc.d/core/"
    dest: "{{ansible_env.HOME}}/.zshrc.d/core/"
    mode: 0744
  notify: execute source shell_dotfile
  tags:
    - dotfiles

- name: Copy scripts files
  copy:
    src: "scripts/"
    dest: "{{ansible_env.HOME}}/scripts/"
    mode: 0744
  tags:
    - dotfiles

- name: Copy autoenv file in ~/Projects directory
  copy:
    src: "autoenv/.env"
    dest: "{{ansible_env.HOME}}/Projects/"
  tags:
    - dotfiles
